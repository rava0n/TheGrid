# Web Enumeration

## Manual Web enumeration

### Source Code

A common technique for discovering a technology used on a site is to **view a source code** and search for the word "**Generator**"

<figure><img src="../../../../.gitbook/assets/image (140).png" alt=""><figcaption><p>In this case the website is created with CMS Made Simple.</p></figcaption></figure>

Once we have identified the technology and the version, we can **googling** for exploit or vulnerabilities.

### Cookies

Check the **cookies** on the website ti find out some useful information.

<figure><img src="../../../../.gitbook/assets/image (141).png" alt=""><figcaption></figcaption></figure>

{% hint style="info" %}
Sometimes the name of the cookies can help you to understand the technology used.
{% endhint %}





## Dir/File Enumeration

#### With Evasion

{% code overflow="wrap" %}
```bash
# 500 events per hour
gobuster dir -u http://<IP> -w <WRDLST_FILE> --delay 7000ms -t 1

# -b exclude code http response like 403,404
```
{% endcode %}

#### Brutal Enum

{% code title="Dirbuster" %}
```bash
dirb http://IP
dirb http://IP <WRDLST_FILE>
dirb http://IP <WRDLST_FILE> -X .html
```
{% endcode %}

<pre class="language-bash" data-title="Gobuster"><code class="lang-bash"><strong>gobuster dir -u http://IP -w &#x3C;WRDLST_FILE> 
</strong>gobuster dir -u http://IP -w &#x3C;WRDLST_FILE> -x .php,.xml,.txt -r
gobuster dir -u http://IP/data -w &#x3C;WRDLST_FILE> -x .php,.xml,.txt -r
gobuster dir -u IP/directory -w &#x3C;WRDLST_FILE> -r -U admin -P admin

# avoid SSL check
gobuster dir -u IP/directory -w ... -k

# -b exclude code http response like 403,404
</code></pre>

{% code title="fuff" overflow="wrap" %}
```bash
ffuf -w <WRDLST_FILE>:FUZZ -u http://<DOMAIN>/FUZZ 

# -fc exclude http code response 404
```
{% endcode %}

{% code title="Nmap" %}
```bash
nmap -p 80 --script=http-enum -sV <IP>
```
{% endcode %}

### Usefull wordlists

<details>

<summary>File enum</summary>

```
/usr/share/wordlists/SecLists/Discovery/Web-Content/raft-large-files.txt
/usr/share/wordlists/SecLists/raft-large-files.txt
/usr/share/wordlists/dirb/common.txt
/usr/share/wordlists/SecLists/Discovery/Web-Content/versioning_metafiles.txt
```

</details>

<details>

<summary>Directory enum</summary>

```
/usr/share/wordlists/SecLists/Discovery/Web-Content/directory-list-2.3-big.txt
/usr/share/wordlists/dirb/common.txt
/usr/share/wordlists/dirb/big.txt
/usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt
```

</details>

## Subdomains Enumeration

Follow this page to find some juicy subdomains

{% content-ref url="../../../../bug-hunting/osint/subdomain-enumeration.md" %}
[subdomain-enumeration.md](../../../../bug-hunting/osint/subdomain-enumeration.md)
{% endcontent-ref %}

## Headers Security

#### Strict-Transport-Security

Force the HTTPS protocol, to prevent Man-in-the-Middle (MITM) attack.

```
Strict-Transport-Security: max-age=31536000; includeSubDomains; preload
```

#### Content-Security-Policy (CSP)

Prevent XSS and Data injection attack.&#x20;

{% code overflow="wrap" %}
```
Content-Security-Policy: default-src 'self'; script-src 'self' 'unsafe-inline'; object-src 'none'
```
{% endcode %}

#### X-Frame-Options

Prevent clickjacking attack with loading sites in non athorized iframe

```
X-Frame-Options: SAMEORIGIN
```

#### X-Content-Type-Options

Prevent MIME sniffing attack disabling browser to interpreter some type of MIME.

A user could be induce to download false executable file

```
X-Content-Type-Options: nosniff
```

#### Server without version

Leak server's version if the informations is not hidden.

```
Server: Apache 2.4
```

#### Set-Cookie misconfiguration

* HttpOnly: essetial to prevent XSS attack on the cookies
* Secure

```
Set-Cookie: HttpOnly; Secure;
```



## Git-Dumper

A tool to dump a git repository into a website

{% code title="installation" %}
```bash
pipx install git-dumper
```
{% endcode %}

```bash
git-dumper http://customer.com/.git ./git-dump
```



## Generaic Web enumeration

```bash
# NMAP
sudo nmap -p 80 -sV -O <TARGET_IP>


nmap -p 80 --script=http-headers -sV <TARGET_IP>
nmap -p 80 --script=http-methods --script-args http-methods.url-path=/webdav/ <TARGET_IP>
nmap -p 80 --script=http-webdav-scan --script-args http-methods.url-path=/webdav/ <TARGET_IP>
nmap -p 80 --script=banner -sV IP
```

```bash
whatweb IP
http IP
browsh --startup-url http://IP




# Nikto
nikto -h http://IP -o niktoscan.txt
nikto -h http://IP/index.php?page=arbitrary-file-inclusion.php -Tuning 5 -o nikto.html -Format htm

wget IP

# CUrl
curl IP | more
curl -I http://IP/DIR
curl --digest -u USER:PASS http://IP/DIR

curl -X GET IP
curl -X OPTIONS IP -v
curl -X POST IP
curl -X POST IP/login.php -d "name=john&password=password" -v
curl -X PUT IP

curl IP/uploads/ --upload-file hello.txt
curl -X DELETE IP/uploads/hello.txt -v

# LYNX
lynx IP
```

### Metasloit web enum

```bash
use auxiliary/scanner/http/brute_dirs
use auxiliary/scanner/http/files_dir
use auxiliary/scanner/http/robots_txt
use auxiliary/scanner/http/http_header
use auxiliary/scanner/http/http_login
use auxiliary/scanner/http/http_version
use auxiliary/scanner/http/apache_userdir_enum

# Global set
setg RHOSTS <TARGET_IP>
setg RHOST <TARGET_IP>

## set options depends on the selected module
set HTTP_METHOD GET
set TARGETURI /<DIR>/

set USER_FILE <USERS_LIST>
set PASS_FILE /usr/share/metasploit-framework/data/wordlists/unix_passwords.txt
set VERBOSE false
set AUTH_URI /<DIR>/
exploit
```

