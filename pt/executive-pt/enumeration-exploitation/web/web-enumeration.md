# Web Enumeration

## Dir/File Enumeration

#### With Evasion

{% code overflow="wrap" %}
```bash
# 500 events per hour
gobuster dir -u http://<IP> -w /usr/share/wordlists/SecLists/raft-large-files.txt -b 403,404 --delay 7000ms -t 1
```
{% endcode %}

#### Brutal Enum

{% code title="Dirbuster" %}
```bash
dirb http://IP
dirb http://IP /usr/share/metasploit-framework/data/wordlists/directory.txt
```
{% endcode %}

<pre class="language-bash" data-title="Gobuster"><code class="lang-bash"><strong>gobuster dir -u http://IP -w /usr/share/wordlists/dirb/common.txt -b 403,404
</strong>gobuster dir -u http://IP -w /usr/share/wordlists/dirb/common.txt -b 403,404 -x .php,.xml,.txt -r
gobuster dir -u http://IP/data -w /usr/share/wordlists/dirb/common.txt -b 403,404 -x .php,.xml,.txt -r
gobuster dir -u IP/directory -w /opt/SecLists/Discovery/Web-Content/directory-list-2.3-small.txt -r -U admin -P admin

# avoid SSL check
gobuster dir -u IP/directory -w ... -k
</code></pre>

{% code title="Nmap" %}
```bash
nmap -p 80 --script=http-enum -sV <IP>
```
{% endcode %}

## Virtual Host (vhost) Enumeration

In order to choose what website to show for what domain, many use what is called "virtual hosting". Virtual hosting can be based on a name, an IP, or a port ([read more](https://en.wikipedia.org/wiki/Virtual_hosting#Name-based)).

* HTTP: the use of the `Host` request header. The client uses the `directive to connect to the domain name of the server. Optionally, it can use the` directive to specify a TCP port number on which the server is listening.
* HTTPS: the use of the Server Name Indication (SNI) extension with TLS. The client indicates the hostname it wants to connect to at the start of the handshake process.

{% code title="WFuzz" overflow="wrap" %}
```bash
wfuzz -H "Host: FUZZ.something.com" --hc 404,403 -H "User-Agent: PENTEST" -c -z file,"/path/to/wordlist.txt" $URL

# Hide response with specific
# --hc/hl/hw/hh : code/lines/words/chars

# Show response with specific
# --sc/sl/sw/sh : code/lines/words/chars
```
{% endcode %}

{% code title="Gobuster" %}
```bash
gobuster vhost --useragent "PENTEST" --wordlist "/path/to/wordlist.txt" --url $URL
```
{% endcode %}

{% code title="fuff" overflow="wrap" %}
```bash
ffuf -H "Host: FUZZ.$DOMAIN" -H "User-Agent: PENTEST" -c -w "/path/to/wordlist.txt" -u $URL
```
{% endcode %}



Wordlists:

```
/usr/share/dnsrecon/dnsrecon/data/subdomains-top1mil.txt
/usr/share/dnsrecon/dnsrecon/data/subdomains-top1mil-5000.txt
/usr/share/dnsrecon/dnsrecon/data/subdomains-top1mil-20000.txt
/usr/share/metasploit-framework/data/wordlists/lync_subdomains.txt
/usr/share/metasploit-framework/modules/auxiliary/gather/searchengine_subdomains_collector.rb
/usr/share/amass/wordlists/bitquark_subdomains_top100K.txt
/usr/share/amass/wordlists/subdomains-top1mil-5000.txt
/usr/share/amass/wordlists/subdomains-top1mil-110000.txt
/usr/share/amass/wordlists/subdomains.lst
/usr/share/amass/wordlists/subdomains-top1mil-20000.txt
/usr/share/spiderfoot/spiderfoot/dicts/subdomains.txt
/usr/share/spiderfoot/spiderfoot/dicts/subdomains-10000.txt
```

## Headers Security

#### Strict-Transport-Security

Force the HTTPS protocol, to prevent Man-in-the-Middle (MITM) attack.

```
Strict-Transport-Security: max-age=31536000; includeSubDomains; preload
```

#### Content-Security-Policy (CSP)

Prevent XSS and Data injection attack.&#x20;

{% code overflow="wrap" %}
```
Content-Security-Policy: default-src 'self'; script-src 'self' 'unsafe-inline'; object-src 'none'
```
{% endcode %}

#### X-Frame-Options

Prevent clickjacking attack with loading sites in non athorized iframe

```
X-Frame-Options: SAMEORIGIN
```

#### X-Content-Type-Options

Prevent MIME sniffing attack disabling browser to interpreter some type of MIME.

A user could be induce to download false executable file

```
X-Content-Type-Options: nosniff
```

#### Server without version

Leak server's version if the informations is not hidden.

```
Server: Apache 2.4
```

#### Set-Cookie misconfiguration

* HttpOnly: essetial to prevent XSS attack on the cookies
* Secure

```
Set-Cookie: HttpOnly; Secure;
```



## Git-Dumper

A tool to dump a git repository into a website

{% code title="installation" %}
```bash
pipx install git-dumper
```
{% endcode %}

```bash
git-dumper http://customer.com/.git ./git-dump
```







