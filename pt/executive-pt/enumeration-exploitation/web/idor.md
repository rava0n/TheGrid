# IDOR

IDOR (Insecure Direct Object Reference) is a type of access control vulnerability.

This type of vulnerability can occur when a web server receives user-supplied input to retrieve objects (files, data, documents), too much trust has been placed on the input data, and it is not validated on the server-side to confirm the requested object belongs to the user requesting it.

The ID can be write in **different ways**:

* **Clear-Text**: is most easy way to change that
* **Base64**: using encoded base64, but this we can replicate the encoded base64 with another id
* **Hash**: with the hash we cannot replicate the id but we can use 2 account to test the IDOR vuln

The ID we can **find in this place**:

* **URL** ⇒ /details?user\_id=123
* **PAGE** ⇒ /123/details
*   **HTTP Request to find the parameters**\


    <figure><img src="../../../../.gitbook/assets/image (277).png" alt=""><figcaption></figcaption></figure>

## ID URL parameter

Most common is to change the profile, changing the `id` parameter into a URL.

```bash
 # our profile id
 http://bank.com/profile?user_id=1305
 http://bank.com/profile/1305/details
 
 # milionaire's profile
 http://bank.com/profile?user_id=9999
 http://bank.com/profile/9999/details
```

### Use 2 account

When we have a hash ID, to test this vulnerability we can create 2 account and invert the hash id.

```bash
# user 1 id = 123
http://bank.com/user_id=202cb962ac59075b964b07152d234b70

# user 2 id = 999
http://bank.com/user_id=b706835de79a2b4e80506f582af3676a

# invert the user 1 user_id to try get user 2 information
http://bank.com/user_id=b706835de79a2b4e80506f582af3676a
```



### Create ID list and Fuzzing

If we found a IDOR and the id is a plain-text integer, we can craft a list and using fuff tool we can discover all active account.

{% code title="Craft id_list" %}
```bash
python3 -c 'for i in range(1,2001): print(i)' > id_list.txt
```
{% endcode %}

{% code title="Active ID discovering" %}
```bash
fuff -u 'http://domain.com/info?id=FUZZ' -w id_list.txt -fs $RESP_SIZE | grep FUZZ
```
{% endcode %}

