# Port 21 - IIS FTP

{% code title="Connection" %}
```bash
ftp <IP> <PORT>
```
{% endcode %}

## IIS FTP Enumeration

```
# CHECK THE VERSION
searchsploit vsftpd VERSION
```

```bash
# Enumeration with NetCat
nc -nv IP 21

# NMAP scripts
ls -la /usr/share/nmap/scripts/ | grep ftp-
nmap -sV -p 21 --script SCRIPT IP
```

{% code title="Metasploit Enumerarion" %}
```bash
service postgresql start && msfconsole

search type:auxiliary name:ftp

use auxiliary/scanner/ftp/ftp_login
use auxiliary/scanner/ftp/ftp_version
```
{% endcode %}

## IIS FTP Exploitation

```bash
# Anonymous
ftp IP PORT
anonymous
anonymous

# Hydra brute-force
hydra -L /usr/share/wordlists/metasploit/unix_users.txt -P /usr/share/wordlists/metasploit/unix_passwords.txt IP ftp -I
hydra -l vagrant -P /usr/share/wordlists/metasploit/unix_passwords.txt IP ftp -I
hydra -l vagrant -P /usr/share/wordlists/metasploit/unix_users.txt IP ftp -I
## -L: specify FILE for user brute forcing
## -l: specify USER
## -P: specify FILE for password brute forcing
## -p: specify PASSWORD
## -I: ignore an existing restore file

# Download ftp file
## Download from terminal
wget -m ftp://USER:PASS@IP
wget -m --user=USER --password=PASS ftp://IP

## Download a single file from ftp connection
get FILE
```

> if ftp connection is a site folder, get a backdoor
