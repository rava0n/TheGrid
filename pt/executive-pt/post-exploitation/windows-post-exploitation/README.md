# Windows - Post Exploitation



## Local Enumeration

### System Information

```bash
# shell
systeminfo
wmic qfe get Caption,Description,HotFixID,InstalledOn
# meterpreter
getuid
sysinfo
```

### Users & Groups

```bash
# shell
net users
net localgroup
net localgroup administrators

# meterpreter
getprivs

# msfconsole
# user loggen in the target
use post/windows/gather/enum_logged_on_users
set sessions N
run
```

### Network Information

```bash
# shell
ifconfig /all
route print
arp -a
```

### Processes & Services

```bash
# meterpreter
ps
pgrep SERVICE_NAME # pgrep lsass.exe
migrate PID
# if we cant migrate, need to win privEsc

# shell
net start 
```

### Metasploit Local Enumeration

```bash
# Metasploit
service postgresql start && msfconsole

## Modules
use post/windows/gather/win_privs
use post/windows/gather/enum_logged_on_users
use post/windows/gather/checkvm
use post/windows/gather/enum_applications
use post/windows/gather/enum_computers
use post/windows/gather/enum_patches
use post/windows/gather/enum_shares

set session N
run
```

### Automatic Script

{% embed url="https://github.com/411Hall/JAWS" %}

```bash
# Copy .ps1 script from github in file on attacker machine
# upload on meterpreter session (in C:\Temp)
# run this command on windows shell
powershell.exe -ExecutionPolicy Bypass -File .\jaws-enum.ps1 -OutputFilename JAWS-Enum.txt
```

{% content-ref url="windows-local-enumeration.md" %}
[windows-local-enumeration.md](windows-local-enumeration.md)
{% endcontent-ref %}

***

## PrivEsc

{% content-ref url="windows-privilege-escalation/" %}
[windows-privilege-escalation](windows-privilege-escalation/)
{% endcontent-ref %}

***

## Persistence

{% content-ref url="windows-persistence.md" %}
[windows-persistence.md](windows-persistence.md)
{% endcontent-ref %}

***

## Dump/Crack Hashes

{% content-ref url="windows-dump-crack-hashes.md" %}
[windows-dump-crack-hashes.md](windows-dump-crack-hashes.md)
{% endcontent-ref %}

***

## Clearing Tracks

{% content-ref url="windows-cleaning-tracks.md" %}
[windows-cleaning-tracks.md](windows-cleaning-tracks.md)
{% endcontent-ref %}
