# Abusing Windows Service Misconfig

Windows services are controlled by the **Service Control Manager** (SCM). The SCM manages the status of services, checks their current status, and configures them. Each service has an executable that the SCM runs when a service starts. These executables have special functions to communicate with the SCM, so not any executable can function as a service. Additionally, each service defines the user account it runs under.

View service details for a specific service:

```powershell
sc qc SERVICE_NAME

[SC] QueryServiceConfig SUCCESS

SERVICE_NAME: apphostsvc
        TYPE               : 20  WIN32_SHARE_PROCESS
        START_TYPE         : 2   AUTO_START
        ERROR_CONTROL      : 1   NORMAL
        BINARY_PATH_NAME   : C:\Windows\system32\svchost.exe -k apphost
        LOAD_ORDER_GROUP   :
        TAG                : 0
        DISPLAY_NAME       : Application Host Helper Service
        DEPENDENCIES       :
        SERVICE_START_NAME : localSystem
```

The **BINARY\_PATH\_NAME** shows the executable file, while the **SERVICE\_START\_NAME** indicates the account running the service.



### Insecure Permissions on Service Executable



