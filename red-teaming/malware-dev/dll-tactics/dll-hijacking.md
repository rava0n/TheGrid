# DLL Hijacking

**DLL Hijacking** is a type of cyberattack where an attacker tricks a legitimate application into loading a **malicious Dynamic Link Library (DLL)** instead of the one it actually intended to load. This can allow the attacker to execute arbitrary code with the privileges of the targeted application.



#### How it works:

* **Target Identification**\
  The attacker **finds a vulnerable application** that **loads DLLs insecurely** (e.g., using a relative path).
* **Malicious DLL Creation**\
  The attacker **creates a DLL with the same name as a legitimate one**, containing malicious code (e.g., reverse shell).
* **DLL Placement**\
  The attacker **places the malicious DLL** in a location that gets searched **before** the legitimate one (e.g., application’s folder or current directory).
* **Execution**\
  When the application runs, it loads the attacker’s DLL. This can result in:
  * Arbitrary code execution
  * Privilege escalation
  * Persistence

{% embed url="https://www.wietzebeukema.nl/blog/hijacking-dlls-in-windows" %}

## Mitigations

#### For Developers:

* Always use **fully-qualified paths** when loading DLLs.
* Use **signed DLLs** and validate signatures.
* Place critical DLLs in secure system paths.
* Implement **DLL redirection** or **safe loading flags**:
  * Use `SetDllDirectory(NULL);`
  * Use `LoadLibraryEx` with `LOAD_LIBRARY_SEARCH_*` flags

#### For Users/Admins:

* Restrict write permissions to application folders.
* Avoid running apps from untrusted directories (e.g., Downloads).
* Monitor and patch vulnerable apps.
